var k=(a,o,f)=>{if(!o.has(a))throw TypeError("Cannot "+f)};var s=(a,o,f)=>(k(a,o,"read from private field"),f?f.call(a):o.get(a)),n=(a,o,f)=>{if(o.has(a))throw TypeError("Cannot add the same private member more than once");o instanceof WeakSet?o.add(a):o.set(a,f)},d=(a,o,f,l)=>(k(a,o,"write to private field"),l?l.call(a,f):o.set(a,f),f);var p=(a,o,f)=>(k(a,o,"access private method"),f);(function(a,o){typeof exports=="object"&&typeof module<"u"?o(exports,require("axios"),require("form-data")):typeof define=="function"&&define.amd?define(["exports","axios","form-data"],o):(a=typeof globalThis<"u"?globalThis:a||self,o(a["@leapcell/leapcell-js"]={},a.axios,a.FormData))})(this,function(a,o,f){var h,u,y,$,B,F,A,T,M,C,E,w,b,O,I,q,S,_,D,j,x,R,V,N;"use strict";const l=r=>{var t,e;if(r.status!==200){const i=(t=r.data)==null?void 0:t.code,c=(e=r.data)==null?void 0:e.error;throw Error(i&&c?`invalid response status: ${r.status}, error code ${i}, hint: ${c}`:`invalid response status: ${r.status}`)}return!0},W=r=>r!==null&&typeof r=="object",z=(r,t)=>{if(r!=="AND"&&r!=="OR"&&r!=="NOT")return!0;for(const e in t)if(W(t[e]))return!1;return!0},J=(r,t)=>r==="OR"&&Array.isArray(t),P=(r,t)=>r==="AND"&&!z(r,t),G=(r,t)=>r==="NOT"&&Array.isArray(t),v=(r,t)=>P(r,t)?{filter_type:"and",filters:Object.entries(t).map(([e,i])=>v(e,i))}:J(r,t)?{filter_type:"or",filters:t.map(e=>v("AND",e))}:G(r,t)?{filter_type:"not",filters:t.map(e=>v("AND",e))}:{filter_type:"single",field:r,op:Object.keys(t)[0],val:Object.values(t)[0]},g=r=>{if(!r)return null;const t=Object.keys(r);if(t.length<1)return null;if(t.length>1)return v("AND",r);const e=t[0],i=r[e];return v(e,i)},L=r=>{if(!r)return null;const t=[];for(const e in r)t.push({field:e,order_by:r[e]});return t.length<1?null:t.length===1?{order:t[0]}:{orders:t}};class H{constructor(t,e){n(this,y);n(this,h,void 0);n(this,u,void 0);d(this,h,t),d(this,u,e)}async findById(t){const e=await s(this,h).axios.get(`${p(this,y,$).call(this)}/record/${t}`,{params:{name_type:s(this,u).nameType}});return l(e),e.data.data.record}async findMany(t){t||(t={});let e={...t.select,name_type:s(this,u).nameType};const i=g(t.where);i&&(e.filter=i);const c=L(t.orderBy);c&&(e={...e,...c});const m=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record/query`,e);return l(m),m.data.data.records}async count(t){var c;let e={name_type:s(this,u).nameType};if(e={...e,metric:{aggr:"count",field:"*"}},t){if(t.where){const m=g(t.where);m&&(e.filter=m)}t.distinct&&(e.metric={aggr:"count",field:"*",condition:"distinct"})}const i=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record/metrics`,e);return l(i),((c=i.data.data.metric)==null?void 0:c.value)||0}async first(t){let e={...t.select,name_type:s(this,u).nameType};const i=g(t.where);i&&(e.filter=i);const c=L(t.orderBy);c&&(e={...e,...c}),e={...e,limit:1};const m=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record/query`,e);return l(m),m.data.data[0]?m.data.data[0]:null}async create(t){const e=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record`,{record:t,name_type:s(this,u).nameType});return l(e),e.data.data}async createMany(t){const e=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record`,{records:t,name_type:s(this,u).nameType});return l(e),e.data.data}async updateById(t){const e=await s(this,h).axios.put(`${p(this,y,$).call(this)}/record/${t.id}`,{fields:t.data,name_type:s(this,u).nameType});return l(e),e.data.data}async updateMany(t){const e={fields:t.data,name_type:s(this,u).nameType},i=g(t.where);i&&(e.filter=i);const c=await s(this,h).axios.put(`${p(this,y,$).call(this)}/record`,e);return l(c),c.data}async deleteById(t){const e=await s(this,h).axios.delete(`${p(this,y,$).call(this)}/record/${t}`);return l(e),e.data}async deleteMany(t){const e={name_type:s(this,u).nameType},i=g(t.where);i&&(e.filter=i);const c=await s(this,h).axios.delete(`${p(this,y,$).call(this)}/record`,{data:e});return l(c),c.data}async search(t){var Q;let e={name_type:s(this,u).nameType,search_fields:t.search_fields||[],offset:t.offset,limit:t.limit,boostFields:t.boostFields,query:t.query,fields:((Q=t.select)==null?void 0:Q.fields)||[]};const i=g(t.where);i&&(e.filter=i);const c=L(t.orderBy);c&&(e={...e,...c});const m=await s(this,h).axios.post(`${p(this,y,$).call(this)}/record/search`,e);return l(m),m.data.data.records}}h=new WeakMap,u=new WeakMap,y=new WeakSet,$=function(){return`/${s(this,u).resource}/table/${s(this,u).tableId}`};class X{constructor(t,e){n(this,B,void 0);n(this,F,void 0);d(this,B,t),d(this,F,e)}}B=new WeakMap,F=new WeakMap;class Y{constructor(t,e){n(this,M);n(this,A,void 0);n(this,T,void 0);d(this,A,t),d(this,T,e)}async upload(t){const e=new f;e.append("file",t,{filename:"file"});const i=await s(this,A).axios.post(`${p(this,M,C).call(this)}/upload`,e,{headers:{"Content-Type":"multipart/form-data"}});return l(i),i.data.data}}A=new WeakMap,T=new WeakMap,M=new WeakSet,C=function(){return`/${s(this,T).resource}/table/${s(this,T).tableId}`};class K{constructor(t){n(this,E,void 0);d(this,E,t)}static createInst(t,e){return new Z(t,e)}}E=new WeakMap;class Z{constructor(t,e){n(this,w,void 0);n(this,b,void 0);n(this,O,void 0);n(this,I,void 0);n(this,q,void 0);d(this,w,t),d(this,b,e)}async meta(){const t=await s(this,w).axios.get(`/${s(this,b).resource}/table/${s(this,b).tableId}`,{params:{name_type:s(this,b).nameType}});return l(t),t.data.data}get records(){return s(this,O)||d(this,O,new H(s(this,w),s(this,b)))}get file(){return s(this,I)||d(this,I,new Y(s(this,w),s(this,b)))}get fields(){return s(this,q)||d(this,q,new X(s(this,w),s(this,b)))}}w=new WeakMap,b=new WeakMap,O=new WeakMap,I=new WeakMap,q=new WeakMap;class U{constructor(t){n(this,S,void 0);d(this,S,t)}static createInst(t,e){return new tt(t,e)}}S=new WeakMap;class tt{constructor(t,e){n(this,_,void 0);n(this,D,void 0);n(this,j,void 0);d(this,_,t),d(this,D,e)}get tables(){return s(this,j)||d(this,j,new K(s(this,_)))}table(t,e="name"){return K.createInst(s(this,_),{...s(this,D),tableId:t,nameType:e})}}_=new WeakMap,D=new WeakMap,j=new WeakMap;const et="0.0.1";class st{constructor(t){n(this,R);n(this,x,void 0);n(this,N,void 0);const i={...{endpoint:"https://api.leapcell.io"},...t};d(this,x,{token:i.apiKey,axios:p(this,R,V).call(this,i)})}get repos(){return s(this,N)||d(this,N,new U(s(this,x)))}repo(t){return U.createInst(s(this,x),{resource:t})}project(t){return U.createInst(s(this,x),{resource:t})}}x=new WeakMap,R=new WeakSet,V=function(t){return o.create({headers:{Authorization:`Bearer ${t.apiKey}`,"User-Agent":`Leapcell Javascript-Client/${et}`},baseURL:`${t.endpoint}/api/v1`,validateStatus:()=>!0})},N=new WeakMap,a.Leapcell=st,Object.defineProperty(a,Symbol.toStringTag,{value:"Module"})});
